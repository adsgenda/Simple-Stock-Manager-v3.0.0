import{S as R,G as ue,k as re,U as ce,i as de,d as h,z as D,j as z,s as X,B as H,p as fe,o as g,e as m,c as q,f as C,a as x,b as J,v as ve,A as ge,V as P,n as M,F as Q,h as me,l as be,t as A,u as F}from"./app-DvcEWBb-.js";import{_ as ye}from"./Label-Vj9Pqrhi.js";import{_ as he}from"./InputError-CKMLs-tu.js";import{v as pe}from"./v4-CQkTLCs1.js";function ke(e){var n=typeof e;return e!=null&&(n=="object"||n=="function")}var U=ke,Se=typeof R=="object"&&R&&R.Object===Object&&R,we=Se,Te=we,xe=typeof self=="object"&&self&&self.Object===Object&&self,je=Te||xe||Function("return this")(),le=je,$e=le,Oe=function(){return $e.Date.now()},Ve=Oe,_e=/\s/;function Ee(e){for(var n=e.length;n--&&_e.test(e.charAt(n)););return n}var Ce=Ee,Ae=Ce,Ie=/^\s+/;function Le(e){return e&&e.slice(0,Ae(e)+1).replace(Ie,"")}var Be=Le,Ne=le,Re=Ne.Symbol,oe=Re,Y=oe,ie=Object.prototype,Fe=ie.hasOwnProperty,Ke=ie.toString,I=Y?Y.toStringTag:void 0;function Ge(e){var n=Fe.call(e,I),l=e[I];try{e[I]=void 0;var c=!0}catch{}var u=Ke.call(e);return c&&(n?e[I]=l:delete e[I]),u}var Pe=Ge,Me=Object.prototype,We=Me.toString;function Ue(e){return We.call(e)}var De=Ue,Z=oe,ze=Pe,Xe=De,He="[object Null]",qe="[object Undefined]",ee=Z?Z.toStringTag:void 0;function Je(e){return e==null?e===void 0?qe:He:ee&&ee in Object(e)?ze(e):Xe(e)}var Qe=Je;function Ye(e){return e!=null&&typeof e=="object"}var Ze=Ye,et=Qe,tt=Ze,at="[object Symbol]";function nt(e){return typeof e=="symbol"||tt(e)&&et(e)==at}var rt=nt,lt=Be,te=U,ot=rt,ae=NaN,it=/^[-+]0x[0-9a-f]+$/i,st=/^0b[01]+$/i,ut=/^0o[0-7]+$/i,ct=parseInt;function dt(e){if(typeof e=="number")return e;if(ot(e))return ae;if(te(e)){var n=typeof e.valueOf=="function"?e.valueOf():e;e=te(n)?n+"":n}if(typeof e!="string")return e===0?e:+e;e=lt(e);var l=st.test(e);return l||ut.test(e)?ct(e.slice(2),l?2:8):it.test(e)?ae:+e}var ft=dt,vt=U,W=Ve,ne=ft,gt="Expected a function",mt=Math.max,bt=Math.min;function yt(e,n,l){var c,u,p,a,o,i,k=0,w=!1,T=!1,d=!0;if(typeof e!="function")throw new TypeError(gt);n=ne(n)||0,vt(l)&&(w=!!l.leading,T="maxWait"in l,p=T?mt(ne(l.maxWait)||0,n):p,d="trailing"in l?!!l.trailing:d);function S(s){var y=c,$=u;return c=u=void 0,k=s,a=e.apply($,y),a}function f(s){return k=s,o=setTimeout(_,n),w?S(s):a}function V(s){var y=s-i,$=s-k,N=n-y;return T?bt(N,p-$):N}function E(s){var y=s-i,$=s-k;return i===void 0||y>=n||y<0||T&&$>=p}function _(){var s=W();if(E(s))return j(s);o=setTimeout(_,V(s))}function j(s){return o=void 0,d&&c?S(s):(c=u=void 0,a)}function L(){o!==void 0&&clearTimeout(o),k=0,c=i=u=o=void 0}function B(){return o===void 0?a:j(W())}function b(){var s=W(),y=E(s);if(c=arguments,u=this,i=s,y){if(o===void 0)return f(i);if(T)return clearTimeout(o),o=setTimeout(_,n),S(i)}return o===void 0&&(o=setTimeout(_,n)),a}return b.cancel=L,b.flush=B,b}var ht=yt,pt=ht,kt=U,St="Expected a function";function wt(e,n,l){var c=!0,u=!0;if(typeof e!="function")throw new TypeError(St);return kt(l)&&(c="leading"in l?!!l.leading:c,u="trailing"in l?!!l.trailing:u),pt(e,n,{leading:c,maxWait:n,trailing:u})}var Tt=wt;const xt=ue(Tt);function jt(e,n,l){if(!e)throw new Error("A target component has to be provided.");if(!n)throw new Error("A callback has to be provided.");const c=u=>{u.target===e.value||u.composedPath().includes(e.value)||u.target===l.value||u.composedPath().includes(l.value)||typeof n=="function"&&n()};re(()=>{window.addEventListener("click",c)}),ce(()=>{window.removeEventListener("click",c)})}const $t={class:"col-span-6 sm:col-span-4"},Ot=["for"],Vt=["id","readonly","placeholder"],_t={class:"max-h-56 rounded-md bg-white dark:bg-gray-900 shadow-lg dark:border dark:border-gray-700 text-base overflow-auto focus:outline-none sm:text-sm"},Et={key:0},Ct=["onClick"],At={class:"ml-3 block font-normal truncate"},It={key:1,class:"bg-blue-600 text-white cursor-default select-none relative py-2 pl-3 pr-9"},Lt={class:"flex items-center"},Bt={class:"ml-3 block font-normal truncate"},Nt={key:0},Rt={key:1},Ft={key:2},Kt={key:3},Dt={__name:"AutoCompleteApi",props:{id:{type:String,default(){return pe()}},json:Boolean,label:String,error:String,position:String,selected:String,defaultText:String,placeholder:String,disable:[String,Number],modelValue:[String,Number],suggestions:[String,Array],valueKey:{type:String,default:"value"},labelKey:{type:String,default:"label"},clearable:{type:Boolean,default:!1},searchable:{type:Boolean,default:!0},keepFocus:{type:Boolean,default:!1},resetSearch:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(e,{emit:n}){const{t:l}=de({}),c=h(null),u=h(null),p=n,a=e,o=h(""),i=h([]),k=h(null),w=h(!1),T=h(""),d=h(null),S=h(!1),f=h(null);jt(u,()=>w.value=!1,c),D(()=>a.modelValue,async t=>{t||(o.value="",await b())}),D(o,t=>{a.searchable&&(w.value=!0,Array.isArray(a.suggestions)?i.value=t?a.suggestions.filter(r=>j(r,t)):a.suggestions:t&&(S.value=!0,_(t)))});const V=z(()=>j(f.value)),E=z(()=>L(f.value));re(async()=>{Array.isArray(a.suggestions)&&(i.value=a.suggestions),a.modelValue&&(Array.isArray(a.suggestions)?(f.value=a.suggestions.find(t=>t==a.modelValue||t[a.valueKey]==a.modelValue||t.value==a.modelValue||t.id==a.modelValue),d.value=a.suggestions.findIndex(t=>t==a.modelValue||t[a.valueKey]==a.modelValue||t.value==a.modelValue||t.id==a.modelValue),o.value=V.value,await X(),await b()):H.post(a.suggestions,{id:a.modelValue}).then(t=>{d.value=0,i.value=t.data,f.value=t.data[0],o.value=j(f.value)}).finally(async()=>{await b(),S.value=!1}))});const _=xt(t=>{var v;let r=i.value;r!=null&&r.length&&r[0],t&&t!=T.value&&((v=a.modelValue)==null?void 0:v.value)!=o.value?(T.value=t,H.post(a.suggestions,{search:t}).then(O=>{i.value=O.data,i.value.length==1&&K(null,0)}).finally(()=>S.value=!1)):S.value=!1},300),j=(t,r)=>{if(t===null)return null;if(typeof t!="object")return t;let v="";return a.labelKey?v=a.labelKey:t.label!==void 0?v="label":t.name!==void 0&&(v="name"),r?v?t[v].toLowerCase().includes(r.toString().toLowerCase()):t.toLowerCase().includes(r.toLowerCase()):v?t[v]:t},L=t=>{if(t===null)return null;if(typeof t!="object")return t;let r="";return a.valueKey?r=a.valueKey:t.value!==void 0?r="value":t.id!==void 0&&(r="id"),r?t[r]:t},B=()=>{w.value=!0,o.value="",k.value.select(),f.value||(d.value=0)},b=async()=>{f.value&&(o.value=V.value),await X(),w.value=!1},s=async()=>(K(null,d.value),await b(),!1),y=()=>{d.value>0&&d.value--},$=()=>{d.value<i.value.length-1&&d.value++},N=t=>t==d.value,K=async(t,r,v=!1)=>{t?(f.value=t,d.value=r,p("update:modelValue",a.json?f.value:E.value),o.value=a.resetSearch?"":V.value):r!==void 0?(d.value=r,f.value=i.value[r],p("update:modelValue",a.json?f.value:E.value),o.value=a.resetSearch?"":V.value):(d.value=null,f.value=null),v&&(i.value=[]),a.resetSearch&&(f.value=null),a.keepFocus&&k.value.focus(),b()},se=async()=>{o.value="",p("update:modelValue",""),await b()};return(t,r)=>{const v=fe("icons");return g(),m("div",$t,[e.label?(g(),q(ye,{key:0,for:e.id,value:e.label},null,8,["for","value"])):C("",!0),x("div",{ref_key:"excludeRef",ref:c,class:"relative mt-1 mb-2 flex items-center"},[x("label",{for:e.id,class:"cursor-pointer absolute top-0 right-0 border border-transparent p-3 text-gray-500 dark:text-gray-400"},[J(v,{name:"chevron-down","class-name":"w-5 h-6"})],8,Ot),e.clearable&&e.modelValue?(g(),m("button",{key:0,type:"button",onClick:r[0]||(r[0]=O=>se()),class:"cursor-pointer focus:outline-none absolute top-0 right-8 border border-transparent p-2 text-gray-500 hover:text-red-500"},[J(v,{name:"cross","class-name":"w-4 h-6"})])):C("",!0),ve(x("input",{id:e.id,ref_key:"input",ref:k,onFocus:B,onClick:B,onKeyup:[P(y,["up"]),P($,["down"]),P(s,["enter"])],"onUpdate:modelValue":r[1]||(r[1]=O=>o.value=O),autocomplete:"off",readonly:!e.searchable,placeholder:e.placeholder||e.label,class:M([{"border-red-500":e.error,"pr-8":!e.clearable,"pr-16":e.clearable},"w-full block text-base py-2 pl-4 placeholder-gray-400 border border-gray-300 dark:border-gray-700 focus:outline-none focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50 rounded-md shadow-sm dark:bg-gray-800"])},null,42,Vt),[[ge,o.value]]),w.value?(g(),m("div",{key:1,ref_key:"componentRef",ref:u,class:M([e.position,"absolute mt-2 top-full w-full rounded-md z-20"])},[x("ul",_t,[i.value&&i.value.length?(g(!0),m(Q,{key:0},me(i.value,(O,G)=>(g(),m(Q,{key:G},[e.disable&&e.disable==L()?C("",!0):(g(),m("li",Et,[x("button",{type:"button",onClick:be(Gt=>K(O,G),["stop","prevent"]),class:M([N(G)?"bg-blue-600 text-white":"text-gray-900 dark:text-gray-100","w-full text-left flex items-center select-none relative py-2 pl-3 pr-9 hover:bg-blue-600 hover:text-white"])},[x("span",At,A(j(O)),1)],10,Ct)]))],64))),128)):(g(),m("li",It,[x("div",Lt,[x("span",Bt,[S.value?(g(),m("span",Nt,A(F(l)("Searching for results"))+"...",1)):i.value==null?(g(),m("span",Rt,A(F(l)("Scan barcode or search items for next")),1)):e.json?(g(),m("span",Ft,A(e.defaultText||F(l)("Please type to search")),1)):(g(),m("span",Kt,A(F(l)("No result suggestions to list.")),1))])])]))])],2)):C("",!0)],512),e.error?(g(),q(he,{key:1,message:e.error,class:"mt-0"},null,8,["message"])):C("",!0)])}}};export{Dt as _};
